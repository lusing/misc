# v8基础

## V8中的日志

通过前面的文章，我们知道如何编译v8.

下面我们看下如何查看v8中的日志。
为了提升性能，v8默认是不打印日志的，我们可以通过设置d8参数的方式打印日志到文件，默认写到v8.log文件中。

为了达到日志丰富度和性能的平衡，打印日志的参数也有好几种。

最初级的是`--log`.

我的v8打印的内容如下：

```
v8-version,9,7,37,0,0
v8-platform,macos,macos
new,CodeRange,0x3a8300000000,0
new,MemoryChunk,0x3a8308000000,262144
...
new,MemoryChunk,0x3a83081c0000,262144
heap-capacity,1014688
heap-available,4295685952
new,MemoryChunk,0x3a8308200000,262144
...
new,MemoryChunk,0x3a83082c0000,262144
```

这段打印的逻辑在log-utils.cc中：

```cpp
void Log::WriteLogHeader() {
  Log::MessageBuilder msg(this);
  LogSeparator kNext = LogSeparator::kSeparator;
  msg << "v8-version" << kNext << Version::GetMajor() << kNext
      << Version::GetMinor() << kNext << Version::GetBuild() << kNext
      << Version::GetPatch();
  if (strlen(Version::GetEmbedder()) != 0) {
    msg << kNext << Version::GetEmbedder();
  }
  msg << kNext << Version::IsCandidate();
  msg.WriteToLogFile();
  msg << "v8-platform" << kNext << V8_OS_STRING << kNext << V8_TARGET_OS_STRING;
  msg.WriteToLogFile();
}
```

比如我们想给自己编译的v8上加个标记，就可以加到log-utils.cc里：
```cpp
  msg << "[xulun modified v8]";
  msg.WriteToLogFile();
```

