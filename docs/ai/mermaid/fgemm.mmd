graph TD  
    A[开始]  
    A --> B[初始化CUBLAS库]  
    B --> C[检查CUBLAS初始化是否成功]  
    C -->|成功| D[分配主机内存给矩阵A、B、C]  
    C -->|失败| E[打印错误信息]  
    E --> F[结束]  
  
    D --> G[分配成功]  
    G --> H[填充矩阵A、B、C]  
    H --> I[分配设备内存给矩阵A、B、C]  
    I -->|成功| J[复制主机内存中的矩阵到设备内存]  
    I -->|失败| K[打印错误信息]  
    J -->|成功| L[使用CPU进行矩阵乘法计算]  
    J -->|失败| M[打印错误信息]  
    L --> N[计算成功]  
    N --> O[使用CUBLAS在GPU上进行矩阵乘法计算]  
    O -->|成功| P[计算成功]  
    O -->|失败| Q[打印错误信息]  
    P --> R[为结果分配主机内存]  
    R --> S[读取设备内存中的结果到主机内存]  
    S -->|成功| T[计算误差并与参考结果进行比较]  
    S -->|失败| U[打印错误信息]  
    T --> V[参考范数不为0]  
    V --> W[清理内存]  
    V --> X[关闭CUBLAS库]  
    V --> Y[检查误差是否在可接受范围内]  
    Y -->|在可接受范围内| Z[打印通过测试信息]  
    Y -->|不在可接受范围内| AA[打印失败测试信息]  
    Z --> BB[结束]  
    AA --> BB  
    V -->|参考范数为0| CC[打印错误信息]  
    CC --> BB  
    U --> BB  
    M --> BB  
    Q --> BB  
    X -->|成功| DD[打印通过测试信息]  
    X -->|失败| EE[打印错误信息]  
    DD --> BB  
    EE --> BB  